\section{Orthogonal Projection}

\begin{bigidea}
The point in a subspace $U \subset \mathbb{R}^n$ nearest to $\bs{x} \in \mathbb{R}^n$ is the orthogonal projection $\mathrm{proj}_U (\bs{x})$ of $\bs{x}$ onto $U$.
\end{bigidea}

\begin{definition}
The {\bf projection} \cite[p.419]{KN} of a vector $\bs{x}$ onto a vector $\bs{u}$ is
$$
\mathrm{proj}_{\bs{u}}(\bs{x}) = \frac{\bs{x} \cdot \bs{u}}{\| \bs{u} \|^2} \bs{u}
$$
\end{definition}

\begin{note}
Projection onto $\bs{u}$ is given by matrix multiplication
$$
\mathrm{proj}_{\bs{u}}(\bs{x}) = P \bs{x}
\ \ \text{where} \ \
P = \frac{1}{\| \bs{u} \|^2} \bs{u} \bs{u}^T
$$
Note that $P^2 = P$, $P^T = P$ and $\mathrm{rank}(P) = 1$.
\end{note}


\begin{theorem}
Let $\{ \bs{u}_1 , \dots , \bs{u}_m \}$ be a basis of a subspace $U \subset \mathbb{R}^n$. The {\bf Gram-Schmidt orthogonalization algorithm} \cite[p.417]{KN} constructs an orthogonal basis of $U$:
\begin{align*}
\bs{v}_1 &= \bs{u}_1 \\
\bs{v}_2 &= \bs{u}_2 - \mathrm{proj}_{\bs{v}_1}(\bs{u}_2) \\
\bs{v}_3 &= \bs{u}_3 - \mathrm{proj}_{\bs{v}_1}(\bs{u}_3) - \mathrm{proj}_{\bs{v}_2}(\bs{u}_3) \\
& \ \ \vdots \\
\bs{v}_m &= \bs{u}_m - \mathrm{proj}_{\bs{v}_1}(\bs{u}_m) - \mathrm{proj}_{\bs{v}_2}(\bs{u}_m) - \cdots - \mathrm{proj}_{\bs{v}_{m-1}}(\bs{u}_m)
\end{align*}
Then $\{ \bs{v}_1 , \dots , \bs{v}_m \}$ is an orthogonal basis of $U$. Furthermore, let
$$
\bs{w}_k = \frac{\bs{v}_k}{\| \bs{v}_k \|} \ \ , \ k=1,\dots,m
$$
Then $\{ \bs{w}_1 , \dots , \bs{w}_m \}$ is an orthonormal basis of $U$. 
\end{theorem}

\begin{example}
Construct an orthonormal basis of the subspace $U$ spanned by
$$
\bs{u}_1 = \begin{bmatrix} 1 \\ 0 \\ 1 \\ 0 \end{bmatrix}
\hspace{5mm}
\bs{u}_2 = \begin{bmatrix} 1 \\ 1 \\ 1 \\ 0 \end{bmatrix}
\hspace{5mm}
\bs{u}_3 = \begin{bmatrix} 1 \\ 1 \\ 0 \\ 0 \end{bmatrix}
$$
Compute
\begin{align*}
\bs{v}_1 &= \bs{u}_1 \\
\bs{v}_2 &= \bs{u}_2 - \mathrm{proj}_{\bs{v}_1}(\bs{u}_2) \\
\bs{v}_3 &= \bs{u}_3 - \mathrm{proj}_{\bs{v}_1}(\bs{u}_3) - \mathrm{proj}_{\bs{v}_2}(\bs{u}_3)
\end{align*}
and we find an orthogonal basis
$$
\bs{v}_1 = \begin{bmatrix} 1 \\ 0 \\ 1 \\ 0 \end{bmatrix}
\hspace{5mm}
\bs{v}_2 = \begin{bmatrix} 0 \\ 1 \\ 0 \\ 0 \end{bmatrix}
\hspace{5mm}
\bs{v}_3 = \frac{1}{2} \left[ \begin{array}{r} 1 \\ 0 \\ -1 \\ 0 \end{array} \right]
$$
and an orthonormal basis
$$
\bs{w}_1 = \frac{1}{\sqrt{2}} \begin{bmatrix} 1 \\ 0 \\ 1 \\ 0 \end{bmatrix}
\hspace{5mm}
\bs{w}_2 = \begin{bmatrix} 0 \\ 1 \\ 0 \\ 0 \end{bmatrix}
\hspace{5mm}
\bs{w}_3 = \frac{1}{\sqrt{2}} \left[ \begin{array}{r} 1 \\ 0 \\ -1 \\ 0 \end{array} \right]
$$
\end{example}

\begin{definition}
Let $U \subset \mathbb{R}^n$ be a subspace and let $\{ \bs{u}_1, \dots, \bs{u}_m \}$ be an orthogonal basis of $U$. The {\bf orthogonal projection} \cite[p.420]{KN} of a vector $\bs{x}$ onto $U$ is
$$
\mathrm{proj}_U(\bs{x}) = \frac{\bs{x} \cdot \bs{u}_1}{\| \bs{u}_1 \|^2} \bs{u}_1 + \cdots + \frac{\bs{x} \cdot \bs{u}_m}{\| \bs{u}_m \|^2} \bs{u}_m
$$
\end{definition}

\begin{note}
Projection onto $U$ is given by matrix multiplication
$$
\mathrm{proj}_{\bs{U}}(\bs{x}) = P \bs{x}
\ \ \text{where} \ \
P = \frac{1}{\| \bs{u}_1 \|^2} \bs{u}_1 \bs{u}_1^T + \cdots + \frac{1}{\| \bs{u}_m \|^2} \bs{u}_m \bs{u}_m^T
$$
Note that $P^2 = P$, $P^T = P$ and $\mathrm{rank}(P) = m$.
\end{note}

\begin{definition}
A matrix $P$ is an {\bf orthogonal projector} (or {\bf orthogonal projection matrix}) if $P^2 = P$ and $P^T = P$ \cite[p.110]{MH}.
\end{definition}

\begin{proposition}
Let $P$ be the orthogonal projection onto $U$. Then $I - P$ is the orthogonal projection matrix onto $U^{\perp}$. 
\end{proposition}

\begin{example}
Find the orthogonal projection matrix $P$ which projects onto the subspace spanned by the vectors
$$
\bs{u}_1 = \left[ \begin{array}{r} 1 \\ 0 \\ -1 \end{array} \right]
\hspace{5mm}
\bs{u}_2 = \left[ \begin{array}{r} 1 \\ 1 \\ 1 \end{array} \right]
$$
Compute $\bs{u}_1 \cdot \bs{u}_2 = 0$ therefore the vectors are orthogonal. Compute
\begin{align*}
P = \frac{1}{\| \bs{u}_1 \|^2} \bs{u}_1 \bs{u}_1^T +  \frac{1}{\| \bs{u}_2 \|^2} \bs{u}_2 \bs{u}_2^T
&= \frac{1}{2} \left[ \begin{array}{r} 1 \\ 0 \\ -1 \end{array} \right]
\raisebox{4mm}{$\left[ \begin{array}{rrr} 1 & 0 & -1 \end{array} \right]$}
+ \frac{1}{3} \left[ \begin{array}{r} 1 \\ 1 \\ 1 \end{array} \right]
\raisebox{4mm}{$\left[ \begin{array}{rrr} 1 & 1 & 1 \end{array} \right]$} \\
&= \frac{1}{2} \left[ \begin{array}{rrr} 1 & \phantom{+}0 & -1 \\ 0 & 0 & 0 \\ -1 & 0 & 1 \end{array} \right]
+ \frac{1}{3} \left[ \begin{array}{rrr} 1 & 1 & 1 \\ 1 & 1 & 1 \\ 1 & 1 & 1 \end{array} \right]
=
\frac{1}{6} \left[ \begin{array}{rrr} 5 & 2 & 1 \\ 2 & 2 & 2 \\ -1 & 2 & 5 \end{array} \right]
\end{align*}
\end{example}

\begin{example}
Find the orthogonal projection matrix $P_{\perp}$ which projects onto $U^{\perp}$ where $U$ the subspace spanned by the vectors
$$
\bs{u}_1 = \left[ \begin{array}{r} 1 \\ 0 \\ -1 \end{array} \right]
\hspace{5mm}
\bs{u}_2 = \left[ \begin{array}{r} 1 \\ 1 \\ 1 \end{array} \right]
$$
as in the previous example. Compute
$$
P_{\perp} = I - P =
\left[ \begin{array}{rrr} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{array} \right] - 
\frac{1}{6} \left[ \begin{array}{rrr} 5 & 2 & 1 \\ 2 & 2 & 2 \\ -1 & 2 & 5 \end{array} \right]
=
\frac{1}{6} \left[ \begin{array}{rrr} 1 & -2 & -1 \\ -2 & 4 & -2 \\ 1 & -2 & 1 \end{array} \right]
$$
Note that
$$
\bs{u}_3 = \left[ \begin{array}{r} 1 \\ -2 \\ 1 \end{array} \right]
$$
is orthogonal to both $\bs{u}_1$ and $\bs{u}_2$ and is a basis of the orthogonal complement $U^{\perp}$. Therefore we could also compute
$$
P_{\perp} = \frac{1}{\| \bs{u}_3 \|^2} \bs{u}_3 \bs{u}_3^T =
\frac{1}{6} \left[ \begin{array}{r} 1 \\ -2 \\ 1 \end{array} \right]
\raisebox{4.5mm}{$\left[ \begin{array}{ccc} 1 & -2 & 1 \end{array} \right]$}
= \frac{1}{6} \left[ \begin{array}{rrr} 1 & -2 & -1 \\ -2 & 4 & -2 \\ 1 & -2 & 1 \end{array} \right]
$$
\end{example}

\begin{theorem}
Let $U \subset \mathbb{R}^n$ be a subspace and let $\bs{x} \in \mathbb{R}^n$. Then
$$
\bs{x} - \mathrm{proj}_U(\bs{x}) \in U^{\perp}
$$
and $\mathrm{proj}_U(\bs{x})$ is the closest vector in $U$ to $\bs{x}$ in the sense that
$$
\| \bs{x} - \mathrm{proj}_U(\bs{x}) \| < \| \bs{x} - \bs{y} \| \hspace{5mm} \text{ for all } \bs{y} \in U \ , \ \bs{y} \not= \mathrm{proj}_U(\bs{x})
$$
See the {\bf Projection Theorem} \cite[p.420]{KN}.
\end{theorem}

